<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedis - Teste M√≠nimo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">üîß Diagn√≥stico - Feedis</h1>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Status do Sistema</h2>
            <div id="status">Carregando...</div>
        </div>

        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Testes</h2>
            <button onclick="testBasic()" class="bg-blue-500 text-white px-4 py-2 rounded mr-2">Teste B√°sico</button>
            <button onclick="testModules()" class="bg-green-500 text-white px-4 py-2 rounded mr-2">Teste M√≥dulos</button>
            <button onclick="testSupabase()" class="bg-purple-500 text-white px-4 py-2 rounded mr-2">Teste Supabase</button>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">Logs</h2>
            <pre id="logs" class="bg-gray-100 p-4 rounded text-sm"></pre>
        </div>
    </div>

    <script>
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            logs.push(`[${timestamp}] ${type.toUpperCase()}: ${message}`);
            document.getElementById('logs').textContent = logs.join('\n');
            console.log(message);
        }

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<span class="${type}">${message}</span>`;
        }

        function testBasic() {
            try {
                log('Iniciando teste b√°sico...');
                updateStatus('Teste b√°sico em andamento...', 'info');
                
                // Test JavaScript b√°sico
                const testArray = [1, 2, 3];
                const testObject = { name: 'Test', value: 123 };
                
                log('‚úÖ JavaScript b√°sico funcionando');
                log('‚úÖ Arrays: ' + testArray.length + ' itens');
                log('‚úÖ Objetos: ' + JSON.stringify(testObject));
                
                // Test Tailwind
                const testElement = document.createElement('div');
                testElement.className = 'bg-blue-500 p-4';
                log('‚úÖ Tailwind CSS carregado');
                
                updateStatus('Teste b√°sico: OK', 'success');
                log('‚úÖ Teste b√°sico conclu√≠do com sucesso');
                
            } catch (error) {
                log('‚ùå Erro no teste b√°sico: ' + error.message, 'error');
                updateStatus('Teste b√°sico: ERRO', 'error');
            }
        }

        function testModules() {
            try {
                log('Iniciando teste de m√≥dulos...');
                updateStatus('Teste de m√≥dulos em andamento...', 'info');
                
                // Test estrutura de dados
                const appData = {
                    balances: [],
                    revenues: [],
                    receipts: [],
                    suppliers: [],
                    outflows: [],
                    startDate: new Date().toISOString().split('T')[0]
                };
                
                log('‚úÖ Estrutura de dados criada');
                log('‚úÖ Tipos de dados: ' + Object.keys(appData).join(', '));
                
                // Test fun√ß√µes b√°sicas
                function formatCurrency(value) {
                    return new Intl.NumberFormat('pt-BR', {
                        style: 'currency',
                        currency: 'BRL'
                    }).format(value || 0);
                }
                
                const testValue = 1234.56;
                log('‚úÖ Formata√ß√£o de moeda: ' + formatCurrency(testValue));
                
                // Test manipula√ß√£o DOM
                const testDiv = document.createElement('div');
                testDiv.innerHTML = '<p>Teste DOM</p>';
                document.body.appendChild(testDiv);
                document.body.removeChild(testDiv);
                
                log('‚úÖ Manipula√ß√£o DOM funcionando');
                
                updateStatus('Teste de m√≥dulos: OK', 'success');
                log('‚úÖ Teste de m√≥dulos conclu√≠do com sucesso');
                
            } catch (error) {
                log('‚ùå Erro no teste de m√≥dulos: ' + error.message, 'error');
                updateStatus('Teste de m√≥dulos: ERRO', 'error');
            }
        }

        async function testSupabase() {
            try {
                log('Iniciando teste de Supabase...');
                updateStatus('Teste Supabase em andamento...', 'info');
                
                // Test fetch b√°sico
                const response = await fetch('https://httpbin.org/get');
                const data = await response.json();
                
                log('‚úÖ Fetch API funcionando');
                log('‚úÖ Status: ' + response.status);
                
                // Test Supabase client
                try {
                    // Verificar se o arquivo existe
                    const scriptResponse = await fetch('./supabase-client-simple.js');
                    if (scriptResponse.ok) {
                        log('‚úÖ Arquivo Supabase client encontrado');
                        updateStatus('Teste Supabase: OK (arquivo encontrado)', 'success');
                    } else {
                        log('‚ùå Arquivo Supabase client n√£o encontrado');
                        updateStatus('Teste Supabase: ERRO (arquivo n√£o encontrado)', 'error');
                    }
                } catch (fetchError) {
                    log('‚ùå Erro ao buscar arquivo Supabase: ' + fetchError.message);
                    updateStatus('Teste Supabase: ERRO', 'error');
                }
                
                log('‚úÖ Teste Supabase conclu√≠do');
                
            } catch (error) {
                log('‚ùå Erro no teste Supabase: ' + error.message, 'error');
                updateStatus('Teste Supabase: ERRO', 'error');
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            log('P√°gina carregada');
            updateStatus('Sistema pronto para testes', 'success');
            log('‚úÖ DOM carregado');
            log('‚úÖ Event listeners prontos');
        });
    </script>
</body>
</html>
